# Ollivander's Inventory

## Question
[Question Link](https://www.hackerrank.com/challenges/harry-potter-and-wands/problem?isFullScreen=true)

## Answer in SQL Server
    /*
    output:
    - id, age, coins_needed, power
    - order by power desc, age desc
    - non-evil wands
    * when wands have the same power and age, choose the wand with the min price

    steps:
    1. join tables
    2. filter out wands with duplicated power and age
    3. filter out evil wands
    4. sort table
    */

    with price_rank as -- ranks wands based on price for duplicated power & age
    (
        select
            id,
            age,
            coins_needed,
            power,
            rank() over (partition by power, age order by coins_needed) as rk
        from wands w join wands_property p on (w.code = p.code)
        where is_evil = 0
    )

    select
        id,
        age,
        coins_needed,
        power
    from price_rank
    where rk = 1
    order by power desc, age desc
    
## Output
    1038 496 4789 10
    1130 494 9439 10
    1315 492 4126 10
    9 491 7345 10
    858 483 4352 10
    1164 481 9831 10
    1288 464 4952 10
    861 462 8302 10
    412 455 5625 10
    996 451 8884 10
    1608 446 8351 10
    1376 443 1735 10
    1330 430 5182 10
    1633 425 2206 10
    1197 419 3468 10
    441 416 2508 10
    424 413 997 10
    1298 397 3810 10
    1125 395 2299 10
    333 393 926 10
    363 388 4477 10
    785 380 1712 10
    1578 376 9886 10
    455 375 2759 10
    238 374 2016 10
    421 367 4392 10
    346 349 1909 10
    874 348 7212 10
    483 344 8855 10
    1485 340 741 10
    1583 339 3867 10
    983 337 851 10
    185 335 618 10
    1325 318 520 10
    1938 311 2726 10
    1121 310 6498 10
    1773 308 3489 10
    999 301 7322 10
    1456 286 6221 10
    405 284 1187 10
    1903 283 5954 10
    114 279 7915 10
    525 278 3247 10
    707 275 8110 10
    1040 271 4993 10
    1655 264 2027 10
    266 263 2106 10
    1520 259 2533 10
    426 255 9950 10
    1214 254 3927 10
    1161 240 4875 10
    470 235 1794 10
    383 229 918 10
    708 222 941 10
    564 219 4073 10
    1709 211 6749 10
    988 209 1775 10
    1846 208 529 10
    1854 206 4798 10
    668 205 1985 10
    720 199 601 10
    579 189 2951 10
    1369 181 6762 10
    608 177 7538 10
    1723 176 619 10
    447 172 4329 10
    993 171 2922 10
    365 168 4144 10
    466 158 5958 10
    1434 494 683 9
    519 487 6652 9
    1184 483 7376 9
    582 481 615 9
    1556 466 6648 9
    1430 464 9556 9
    834 455 557 9
    644 446 5487 9
    260 438 5182 9
    189 434 5486 9
    1687 430 1188 9
    458 416 9740 9
    494 414 5869 9
    367 413 8763 9
    451 398 1581 9
    1500 395 7326 9
    277 389 2097 9
    1472 386 4466 9
    373 381 8547 9
    1032 380 917 9
    896 376 4113 9
    1626 375 9862 9
    607 374 3734 9
    926 367 792 9
    1347 364 6443 9
    1031 353 6876 9
    1869 349 2140 9
    101 348 3200 9
    1323 345 868 9
    919 340 643 9
    1570 337 9490 9
    679 335 2992 9
    1183 310 1738 9
    647 308 3172 9
    472 306 2022 9
    965 297 4329 9
    1098 292 5141 9
    1300 290 4041 9
    719 279 5192 9
    1327 278 715 9
    1872 275 6149 9
    1753 271 4826 9
    1810 264 2868 9
    1116 263 5321 9
    1781 255 7991 9
    110 254 5558 9
    839 249 3362 9
    1555 247 739 9
    461 243 6003 9
    1720 240 9556 9
    520 233 2584 9
    882 229 3085 9
    1772 219 1780 9
    416 211 7726 9
    1400 209 1568 9
    54 208 1507 9
    111 205 7125 9
    ...
